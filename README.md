# ストップウォッチアプリ

MacOS上で動作する複数ストップウォッチを管理できるアプリケーションです。Electronを使用して開発されています。

## 機能

- ⏱️ **複数ストップウォッチの管理**（複数のストップウォッチを登録可能）
- 📁 **カテゴリ機能**（ストップウォッチをカテゴリごとにグループ化）
- ➕ カテゴリとストップウォッチの追加機能
- 🗑️ **削除機能**（カテゴリごと、または個別のタイマーを削除）
- 📝 **タスク名とカテゴリ名の自由な設定**（例: 仕事、休憩、勉強）
- ⏲️ 00:00:00からカウントアップ（時間計測）
- 📊 **全ストップウォッチの合計時間を上部に表示**（リアルタイム更新）
- 🔒 **排他制御機能**（一度に1つのストップウォッチのみ起動可能）
- 🔄 **自動切り替え**（新しいストップウォッチ起動時に前のものを自動停止）
- 💡 **ハイライト表示**（起動中のタイマーを視覚的に強調）
- 🎯 **常に最前面表示**（他のウィンドウの前に常に表示）
- 🎨 **超コンパクトUI**（400x500の小さなウィンドウ、アイコンボタン採用）
- 🎨 **Material Icons**（Googleの美しいアイコンセット使用）
- 📜 スクロール対応で多数のカテゴリとストップウォッチを管理可能

---

## 開発者向けセットアップガイド

### 必要な環境

- **Node.js**: v16以上（推奨: v18 LTS以上）
- **npm**: v7以上（Node.jsに付属）
- **OS**: macOS（開発・動作確認環境）

### 環境確認

以下のコマンドでバージョンを確認できます：

```bash
node --version   # v16.0.0以上であることを確認
npm --version    # v7.0.0以上であることを確認
```

### プロジェクトのクローン・ダウンロード

```bash
# プロジェクトディレクトリに移動
cd /path/to/timer

# ファイル構成を確認
ls -la
```

### 依存関係のインストール

```bash
# package.jsonに記載された依存関係をインストール
npm install

# インストール完了後、node_modulesディレクトリが作成されます
```

**インストールされる主な依存関係:**
- `electron`: ^27.0.0（メインフレームワーク）

### 開発時の起動方法

```bash
# アプリケーションを起動（開発モード）
npm start
```

または

```bash
# 同じく起動（npm startのエイリアス）
npm run dev
```

**起動後の動作:**
- Electronウィンドウが自動的に開きます
- ウィンドウサイズ: 400x500ピクセル
- タイトルバーに「タイマー」と表示されます

### アプリケーションの停止

- ウィンドウを閉じる（⌘+Q または ウィンドウの×ボタン）
- ターミナルで `Ctrl+C` を押す

---

## プロジェクト構成

```
timer/
├── main.js          # Electronのメインプロセス（ウィンドウ管理）
├── index.html       # UIのHTMLファイル（画面レイアウト）
├── renderer.js      # レンダラープロセス（タイマーロジック）
├── package.json     # プロジェクト設定・依存関係
├── package-lock.json # 依存関係のロックファイル
├── node_modules/    # インストールされた依存パッケージ
├── README.md        # このファイル（ドキュメント）
└── work.md          # 開発要件定義
```

### 各ファイルの役割

#### `main.js`（メインプロセス）
- Electronアプリケーションのエントリーポイント
- ブラウザウィンドウの作成と管理
- アプリケーションのライフサイクル管理
- ウィンドウサイズ: 400x600、リサイズ可能（最小350x400）
- 常に最前面表示（alwaysOnTop: true）

#### `index.html`（UIレイアウト）
- ストップウォッチのUI構造を定義
- スタイル（CSS）を含む
- モダンなグラデーション背景とカード型レイアウト
- スクロール対応のストップウォッチコンテナ

#### `renderer.js`（レンダラープロセス）
- 複数ストップウォッチの管理ロジック
- Stopwatchクラスによるストップウォッチの独立制御
- カウントアップ処理と状態管理
- 動的なストップウォッチカードの生成
- ボタンイベントハンドリング
- 排他制御機能（一度に1つのみ起動可能）

#### `package.json`
- プロジェクトメタデータ
- 依存関係の定義
- npmスクリプトの定義

---

## 使い方

1. **アプリケーションを起動**
   ```bash
   npm start
   ```

2. **ストップウォッチを追加**
   - 「+ ストップウォッチを追加」ボタンをクリック
   - 新しいストップウォッチカードが追加されます（初回は自動で1つ追加されます）

3. **タスク名を設定**
   - 各ストップウォッチカードの「タスク名」フィールドに名前を入力
   - 例: 「作業」「休憩」「勉強」「ミーティング」など

4. **計測開始**
   - 「スタート」ボタンをクリック
   - 00:00:00からカウントアップが始まります
   - **一度に1つのストップウォッチのみが動作します**
   - 他のストップウォッチの「スタート」ボタンを押すと、前のストップウォッチは自動的に停止します
   - 上部に全ストップウォッチの合計時間が表示されます

5. **一時停止・再開**
   - 計測中に「一時停止」ボタンをクリック
   - 停止中は「スタート」ボタンが「再開」に変わります

6. **クリア**
   - 「クリア」ボタンでストップウォッチを00:00:00にリセット
   - 計測を最初からやり直すことができます

---

## 技術スタック

- **Electron**: v27.0.0
  - デスクトップアプリケーションフレームワーク
  - Chromium + Node.jsベース
- **HTML/CSS**: UI構築
  - Flexboxレイアウト
  - CSSグラデーション・トランジション
- **JavaScript (Vanilla)**: ロジック実装
  - フレームワーク不使用
  - シンプルなDOM操作

---

## トラブルシューティング

### アプリが起動しない場合

1. **Node.jsのバージョン確認**
   ```bash
   node --version
   ```
   v16未満の場合は、Node.jsを更新してください。

2. **依存関係の再インストール**
   ```bash
   rm -rf node_modules package-lock.json
   npm install
   ```

3. **キャッシュのクリア**
   ```bash
   npm cache clean --force
   npm install
   ```

### 通知が表示されない場合

- macOSの「システム設定」→「通知」でElectronの通知を許可してください
- 初回起動時に通知の許可ダイアログが表示される場合があります

### ウィンドウが真っ白になる場合

- `main.js`のDevToolsのコメントアウトを解除して、コンソールエラーを確認：
  ```javascript
  mainWindow.webContents.openDevTools();
  ```

---

## 開発のヒント

### デバッグ方法

1. **開発者ツールを開く**
   
   `main.js`の`createWindow`関数内で以下のコメントを解除：
   ```javascript
   mainWindow.webContents.openDevTools();
   ```

2. **コンソールログの確認**
   
   `renderer.js`に`console.log()`を追加してデバッグ：
   ```javascript
   console.log('タイマー開始:', remainingSeconds);
   ```

### ホットリロード

現在、コード変更時は手動でアプリを再起動する必要があります。

```bash
# Ctrl+C でアプリを停止
# 再度起動
npm start
```

### コードの修正箇所

- **UI変更**: `index.html`のHTMLとCSSを編集
- **タイマーロジック変更**: `renderer.js`を編集
- **ウィンドウ設定変更**: `main.js`を編集

---

## 今後の拡張予定（Step10以降）

- [ ] ラップタイム機能
- [ ] 計測履歴の保存とエクスポート（CSV/JSON）
- [ ] タスク別の統計グラフ表示
- [ ] アラーム機能（指定時間経過時に通知）
- [ ] ダークモード対応
- [ ] メニューバー常駐機能
- [ ] ストップウォッチのドラッグ＆ドロップでの並び替え
- [ ] 平均時間の表示
- [ ] 複数ストップウォッチ同時起動モードのオプション追加
- [ ] ウィンドウの透明度調整機能
- [ ] 削除前の確認ダイアログ

---

## 開発要件

このアプリケーションの開発要件は`work.md`に記載されています。

**Step1（完了✅）**: タイマーアプリがMac上で起動すること

**Step2（完了✅）**: 複数タイマーを実装する
- 各タイマーに「時間」「スタート」「一時停止」「クリア」を配置
- 複数のタイマーを独立して管理可能
- タイマー追加機能を実装

**Step3（完了✅）**: タスク名機能を実装
- 各タイマーにタスク名の入力・登録機能を追加
- タスク名は通知にも表示される
- UIの調整は別ステップで実施

**Step4（完了✅）**: ストップウォッチに切り替え
- カウントダウンタイマーからカウントアップのストップウォッチに変更
- 時間入力フィールドを削除
- 00:00:00からカウントアップする時間計測機能を実装

**Step5（完了✅）**: 合計時間表示機能を追加
- 全ストップウォッチの合計経過時間を上部に表示
- リアルタイムで更新される合計時間表示
- 大きく見やすいフォント表示

**Step6（完了✅）**: 排他制御機能を実装
- 一度に1つのストップウォッチのみ起動可能
- 新しいストップウォッチ起動時に前のストップウォッチを自動停止
- タスク切り替えをスムーズに実現

**Step7（完了✅）**: UIを超コンパクトに最適化
- ウィンドウサイズを400x600に縮小
- ボタンをアイコンボタンに変更（▶、⏸、↻）
- 余白を最小化してシンプルなデザインに
- 常に最前面表示機能を追加
- 最前面固定でも邪魔にならない小さなUI

**Step8（完了✅）**: 軽微な改善
- ウィンドウの横幅を固定（400px）
- 追加ボタンのテキスト位置を修正
- タイトルをアイコンのみに簡略化

**Step9（完了✅）**: タイマー削除機能を実装
- 各タイマーカードにゴミ箱アイコンの削除ボタンを追加
- リセットボタンの右側に配置
- クリックでタイマーを即座に削除
- 削除後に合計時間も自動更新

**Step10（完了✅）**: UIをさらにシンプル化
- タスク名入力欄の「タスク:」ラベルを削除
- 上部の⏱️アイコンと「合計」ラベルを削除
- 合計時間を上に詰めてより見やすく

**Step11（完了✅）**: ヘッダーレイアウトの最適化
- 合計時間と追加ボタンを横並びに配置
- ウィンドウの高さを500pxに縮小（最小350px）
- よりコンパクトで邪魔にならないUI

**Step12（完了✅）**: アイコンのビジュアル改善
- Google Material Iconsを導入
- 再生（play_arrow）、一時停止（pause）、リセット（refresh）、削除（delete）アイコンを統一
- 綺麗で視認性の高いアイコンに変更
- プロフェッショナルなデザインに

**Step13（完了✅）**: 起動中タイマーのハイライト表示
- 起動中のタイマーカードを視覚的に強調
- 青いグラデーション背景とボーダーで表示
- スケールアップとシャドウで立体感を演出
- 一時停止や停止時はハイライト解除

**Step14（完了✅）**: カテゴリ機能の実装
- ストップウォッチをカテゴリごとにグループ化
- カテゴリの追加・削除機能
- カテゴリごとにタイマーを追加可能
- カテゴリ名の自由な変更
- 半透明のガラス風カテゴリコンテナ
- カテゴリごとにタイマーを整理して管理

**Step15以降（将来対応）**: 追加要件があれば対応

---

## ライセンス

MIT License

---

## 開発者向けクイックスタート

```bash
# 1. 依存関係をインストール
npm install

# 2. アプリケーションを起動
npm start

# 3. 開発を開始！
# コードを編集して、Ctrl+C で停止、npm start で再起動
```

**開発環境の準備が完了したら、すぐにコーディングを開始できます！**

